.global outbyte
.global outbyte0
.global outbyte1

.equ SYSCALL_NUM_PUTSTRING, 2   /* PUTSTRING */

.section .text
.even

/* 互換用：従来 outbyte はポート0にしておく */
outbyte:
    bra outbyte0

/* -------------------------
 * port0 (UART1)
 * ------------------------- */
outbyte0:
    movem.l %d1-%d3, -(%sp)

outbyte0_loop:
    move.l #SYSCALL_NUM_PUTSTRING, %d0
    move.l #0, %d1              /* ★ port = 0 */
    move.l %sp, %d2
    addi.l #19, %d2             /* (#sp+19) → 1文字バッファ位置 */
    move.l #1, %d3              /* size = 1 */
    trap   #0

    cmpi.l #1, %d0
    bne    outbyte0_loop

    movem.l (%sp)+, %d1-%d3
    rts

/* -------------------------
 * port1 (UART2)
 * ------------------------- */
outbyte1:
    movem.l %d1-%d3, -(%sp)

outbyte1_loop:
    move.l #SYSCALL_NUM_PUTSTRING, %d0
    move.l #1, %d1              /* ★ port = 1 にするだけ */
    move.l %sp, %d2
    addi.l #19, %d2
    move.l #1, %d3
    trap   #0

    cmpi.l #1, %d0
    bne    outbyte1_loop

    movem.l (%sp)+, %d1-%d3
    rts
